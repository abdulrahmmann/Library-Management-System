<app-admin-layout>
  <div class="bg-white rounded-xl p-5">

    <div class="flex items-center justify-between mb-5">
      <h2 class="box-title">All Users</h2>
      <button (click)="toggleSort()"
              class="px-3 py-2 flex items-center gap-1 border-2 border-ghostWhiteColor hover:bg-ghostWhiteColor rounded-lg cursor-pointer">
        <h3 class="font-medium text-primaryDarkColor4 text-sm">
          {{ isAscending ? 'A-Z' : 'Z-A' }}
        </h3>
        <img ngSrc="/arrow-swap.svg" alt="" height="16" width="16"/>
      </button>
    </div>

    <div class="card">
      <p-table
        [value]="allUsers"
        [paginator]="true"
        [rows]="6"
        [tableStyle]="{ 'min-width': '50rem' }"
        [rowsPerPageOptions]="[6, 12, 20]"
      >
        <ng-template #header>
          <tr>
            <th scope="col" class="border-none rounded-tl-sm rounded-bl-sm text-tableColor whitespace-nowrap text-sm">
              Name
            </th>
            <th scope="col" class="border-none text-tableColor whitespace-nowrap text-sm">Date Joined</th>
            <th scope="col" class="border-none text-t ableColor whitespace-nowrap text-sm">Role</th>
            <th scope="col" class="border-none text-tableColor whitespace-nowrap text-sm">Books Borrowed</th>
            <th scope="col" class="border-none text-tableColor whitespace-nowrap text-sm">University ID No</th>
            <th scope="col" class="border-none text-tableColor whitespace-nowrap text-sm">University ID Card</th>
            <th scope="col" class="border-none rounded-tr-sm rounded-br-sm text-tableColor whitespace-nowrap text-sm">
              Action
            </th>
          </tr>
        </ng-template>
        <ng-template #body let-users>
          <tr>
            <td class="text-xs text-tableColor">
              <div class="flex items-center gap-2">
                @if (users.profilePic) {
                  <img [src]="users.profilePic" alt="user img" class="size-10 rounded-full object-contain"/>
                } @else {
                  <div [class]="profilePicService.getStyles(users.name)">
                    {{ users.name.slice(0, 2) }}
                  </div>
                }
                <div>
                  <h2 class="text-primaryDarkColor3 font-semibold text-sm">{{ users.name }}</h2>
                  <p class="text-start text-secondaryGreyColor">{{ users.email }}</p>
                </div>
              </div>

            </td>
            <td class="font-medium text-xs text-tableColor">{{ users.dateJoined | date }}</td>
            @if (users.role === 'Admin') {
              <td class="text-xs text-tableColor">
                <div class="w-fit text-xs font-medium text-[#027A48] bg-[#ECFDF3] rounded-lg px-2 py-1">Admin</div>
              </td>
            } @else if (users.role === 'User') {
              <td class="text-xs text-tableColor">
                <div class="w-fit text-xs font-medium text-[#C11574] bg-[#FDF2FA] rounded-lg px-2 py-1">User</div>
              </td>
            }
            <td class="font-medium text-xs text-tableColor">{{ users.booksBorrowed }}</td>
            <td class="font-medium text-xs text-tableColor">{{ users.universityId }}</td>
            <td class="font-medium text-xs text-tableColor cursor-pointer">
              <div class="flex items-center gap-1">
                <h3 class="text-sm font-medium text-[#0089F1]">View ID Card</h3>
                <img src="/view.svg" alt=""/>
              </div>
            </td>
            <td class="cursor-pointer">
              <div class="card flex justify-center">
                <button (click)="showDialog()" class="btn-trash">
                  <img src="/trash.svg" alt="" />
                </button>
                <p-dialog header="Remove User" [modal]="true" [(visible)]="visible" class="acc-req-modals"
                          [maximizable]="true">
                  <div class="text-center">
                    <img src="/deny.svg" alt="" class="mx-auto"/>
                    <h2 class="text-xl font-semibold text-primaryDarkColor3 mt-3">Are You Sure to Remove The User?</h2>
                    <p class="text-base text-secondaryGreyColor mt-1">
                      Denying this request will notify the student theyâ€™re not <br /> eligible due to unsuccessful ID card
                      verification.
                    </p>
                    <div class="flex items-center gap-2">
                      <button (click)="closeDialog()"
                              class="mt-2  rounded-lg bg-gray-500 text-base font-semibold text-white py-3.5 text-center w-full">
                        Cancel
                      </button>
                      <button
                        class="mt-2  rounded-lg bg-[#F46F70] text-base font-semibold text-white py-3.5 text-center w-full">
                        Remove
                      </button>
                    </div>
                  </div>
                </p-dialog>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

  </div>
</app-admin-layout>
